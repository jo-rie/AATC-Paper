\documentclass{article}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language
\usepackage[english]{babel}
\usepackage[utf8]{inputenc} % für Umlaute
\usepackage{fontenc}

% Set page size and margins
% Replace `letterpaper' with`a4paper' for UK/EU standard size
\usepackage[a4paper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

%%%% ---- Useful packages

%%% --- Figures and Graphics
\usepackage{graphicx}
\usepackage{subcaption}

%%% --- Colors
\usepackage{color}
\usepackage[dvpinames]{xcolor}

%%% --- Tabulars
\usepackage{booktabs}

%%% --- Mathematics
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools}
\usepackage{bm} % bold mathematics
\usepackage{bbm} % for blackboard 1
\usepackage[linesnumbered,lined,algo2e,figure,boxed]{algorithm2e}
\usepackage[short]{optidef} % for aligning linear programs

%%% --- Other
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
%\usepackage[hidelinks]{hyperref}
\usepackage[style=authoryear,backend=bibtex]{biblatex}
%\addbibresource{library.bib}
\usepackage{csquotes}
\usepackage[shortcuts]{extdash} % For Hyphens in English
%\usepackage{acro}
% \DeclareAcronym{pdf}{short=PDF, long={probability distribution function}}

%%% --- Commenting, Todonotes
\usepackage{comment, todonotes}
\newcommand{\ar}{$\rightarrow$}
\presetkeys{todonotes}{backgroundcolor=yellow!30, bordercolor=yellow!50, linecolor=yellow!50, figwidth=\textwidth}{}
\newcommand{\hl}[1]{\textcolor{Aquamarine}{#1}}

%%%% ---- Own Commands
%%% --- Theorem Settings
\theoremstyle{plain}% Theorem-like structures provided by amsthm.sty
\newtheorem{theorem}{Theorem}
\newtheorem{exa}{Example}
\newtheorem{rem}{Remark}
\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}

%%% --- Math Commands

\newcommand{\lag}[1][l]{\Delta_{#1}}
\DeclarePairedDelimiter{\abs}\lvert\rvert

%%% --- Other Commands
\renewcommand{\arraystretch}{1.2}

%%% --- ToDo List
\usepackage{enumitem}
\newlist{todolist}{itemize}{2}
\setlist[todolist]{label=$\square$}
\usepackage{pifont}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\newcommand{\done}{\rlap{$\square$}{\raisebox{2pt}{\large\hspace{1pt}\cmark}}%
\hspace{-2.5pt}}
\newcommand{\wontfix}{\rlap{$\square$}{\large\hspace{1pt}\xmark}}

\title{Trending in Nowcasting}
\author{Oliver Grothe, Bolin Liu, Jonas Rieger}

\begin{document}
\maketitle

%\begin{abstract}
%Your abstract.
%\end{abstract}

\section{ToDos}


\begin{todolist}
\item[\done] Vorlage erstellen (Jonas)
\item[\done] Schätzer einarbeiten (Jonas)
\item[\done] Alternativvorschlag Notation (Bolin)
\item[\done] Aufschreiben der Diskussionsergebnisse (Bolin): Grundproblems, Anforderungen und Beispielmaß
\item Eigenschaften des Beispiel-Maßes untersuchen/ angeben (Jonas, Bolin ) 
\end{todolist}


\input{sections/01-introduction.tex}

\section{Notation}
\begin{itemize}
  \item Sei $T = \{1, 2, \dots\}$ die Zeitindexmenge, wobei für jeden Zeitpunkt $t \in T$ eine Realisierung vorliegt (die ggf. im Nachhinein veröffentlicht wird).
  \item Sei $(Y_t)_{t \in T}$ die Zeitreihe der Realisierungen, dabei steht $t$ für den Zeitpunkt, auf den sich der Wert bezieht, nicht den Veröffentlichungszeitpunkt.
  \item Sei $K = \{1, 2, \dots\}$ die Menge der Nowcaster.
	\begin{itemize}
	  \item Sei $X_{t \lvert \tau}^k (k \in K, t \in T, \tau \in T_t^k)$ der Nowcast von $k$ bezüglich des Zeitpunktes $t$, der am Zeitpunkt $\tau$ \textbf{veröffentlicht} wird (oder: berechnet / dessen Informationen sich auf Zeitpunkt $\tau$ beziehen).
	  \item Sei $g: \mathbb{R}^{\lvert T_t^k \lvert} \rightarrow \mathbb{R}$ eine Aggregationsfunktion, die alle Nowcasts bezüglich eines Zeitpunkts zu einem Nowcast zusammenfasst ($X_t^k \coloneqq g((X_{t \lvert \tau}^k)_{\tau \in T_t^k})$). Falls jeweils nur ein Nowcast veröffentlich wird, wähle $g(x) = x$.
	  \item Sei $(X_t^k)_{t \in T}$ die Zeitreihe der aggregierten Nowcasts.
	\end{itemize}
  \item Sei $\lag[l]$ der lag-$l$-Operator, der für eine Zeitreihe $(Z_t)_{t \in T}$ definiert wird durch 
		\begin{equation}
			\lag[l]Z_t = Z_{t+l} - Z_t \quad (t \in T)
		\end{equation} 
  \item Der Anteil an konkordanten Punkten für Realisierungen $y = (y_1, y_2, \dots, y_n)$ und $(x_1, x_2, \dots, x_n)$ bezüglich des Lag $l$ ergibt sich dann durch
	\begin{equation}
  		k (x, y; l, \epsilon) = \frac{\sum_{t}^{n-l} k^s (\lag y_t, \lag x_t; l, \epsilon)}{\sum_{t}^{n-l} k^\epsilon (\lag y_t, \lag x_t)}
	\end{equation}
	wobei $k^s$ die Indikatorfunktion für die Konkordanz zweier Werte außerhalb der exclusion area ist
	\begin{equation}
  		k^s (x, y; \epsilon) \coloneqq \begin{cases}
  			1 &, \text{falls}\ xy > 0\ \text{und}\ k^\epsilon(x, y; \epsilon) = 1\\
  			0 &, \text{sonst}
  		\end{cases}
	\end{equation}
	und $k^\epsilon$ die Indikatorfunktion für Punkte außerhalb der exclusion area ist
	\begin{equation}
  		k^\epsilon (x, y; \epsilon) \coloneqq \begin{cases}
  			1 &, \text{falls} \ \abs{x} > \epsilon \text{oder} \ \abs{y} > \epsilon \\
  			0 &, \text{sonst}
  		\end{cases}
	\end{equation}
\end{itemize}

\section{Trending-Problem}
\subsection{Grundproblem}
Gegeben sind zwei Zeitreihen $(x_t)$ und $(y_t)$, $t\in \{t_0,...,t_N\}$. Dabei kann $(x_t)$ die zeitliche Entwicklung einer Zielgröße und $(y_t)$ die zeitlichen Schätzungen eines Nowcasters darstellen. Uns interessiert, ob die Entwicklungen der beiden Zeitreihen den gleichen Trend aufweisen bzw. ob der Nowcaster die Entwicklung der zu schätzenden Größe mit dem richtigen Trend schätzen kann. Es sollte ein Maß konstruiert werden, das beschreibt, wie gut zwei Zeitreihen den gleichen Trend aufweisen.
\subsection{Anforderungen an einem Maß/ Intuitionen}

Zwei Zeitreihen weisen den gleichen Trend auf, wenn für zwei beliebige Zeitpunkte $t$ und $\tau$ gilt: $(x_t-x_\tau)(y_t-y_\tau)>0$ oder $x_t=x_\tau \land y_t = y_\tau$.

\todo{Kann man theoretisch nicht einfach mit Rang-korrelations-koeffizient Trending überprüfen?}
\subsection{Ein einfaches Maß}
Sei $\Delta_{t,\tau}^{x}:=x_\tau-x_t$.
\begin{equation}
  		R_{t,\tau}^{x,y} \coloneqq 
        \begin{cases}
  		    \frac{\Delta_{t,\tau}^{x}\Delta_{t,\tau}^{y}}   {\vert\Delta_{t,\tau}^{x}\vert\vert\Delta_{t,\tau}^{y}\vert } &, \text{falls} \Delta_{t,\tau}^{x}\neq 0 \land \Delta_{t,\tau}^{y}\neq0\\
           1 &, \text{falls} \Delta_{t,\tau}^{x}=\Delta_{t,\tau}^{y}=0\\
            -1 &, \text{sonst} 
  	\end{cases}
	\end{equation}
Beispiel-Maß: $S(\bold{x},\bold{y})=\sum_{k=1}^{k^*}\frac{w_k}{N+1-k}\sum_{j=0}^{N-k}R_{t_j,t_{j+k}}^{x,y},$
wobei $w_k, k=1,...,k^*$ eine Gewichtung für das Trending-Verhalten in verschiedenen Zeitdistanzen darstellt. Dabei erfüllt $w_k$ die folgenden Anforderungen:

\begin{itemize}
    \item $w_k$ ist streng monoton fallend in $k$. Hintergrund: je klein der betrachtete Zeitabstand ist, desto größer ist hier der Einfluss des Rauschens
    \item $\sum_{k=1}^{k^*}w_k=1$
\end{itemize}

\subsection{Eigenschaften des vorgeschlagenen Maßes}
\begin{itemize}
    \item Seien $(x_n)$ und $(y_n)$ zwei Realisierungen eines Random Walk -Modells.\\
    Hypothese: $S((x_n),(y_n))=0$. \\
    Intuition:  Zwei Random Walks $(x_n)$ und $(y_n)$ zeigen kein gemeinsames Tendenzverhalten auf. 
\end{itemize}
 
 \subsection{Alternative Notation}

\begin{itemize}
	\item Seien $x_1, x_2, \dots, x_N$ die (aggregierten) Nowcasts; $y_1, x_2, \dots, y_N$ die realisierten Werte
	\item Gewichteter Anteil an konkordanten Differenzen: 
	\begin{equation}
		\sum_{l = 1}^{l^*} \omega_l \sum_{t=1}^{N - l} \frac{\lag x_i \lag y_i}{\abs{\lag x_i} \abs{\lag{y_i}}}, 
	\end{equation}
	wobei $\infty / \infty \coloneqq 1$ und $\infty / - \infty \coloneqq -1$.
	\item Evtl. geschicktere Lokalisierung (0: \enquote{perfekte} Gegenläufigkeit, 1: \enquote{Perfektes} Trending bis Lag $l^*$):
	\begin{equation}
		\sum_{l = 1}^{l^*} \omega_l \sum_{t=1}^{N - l} \frac{1}{2 (N-l)} \left( \frac{\lag x_i \lag y_i}{\abs{\lag x_i} \abs{\lag{y_i}}} + (N-l) \right)
	\end{equation}
\end{itemize}



\section{Statistische Modellierung}
\subsection{Modellierung}
\begin{itemize}
  \item Sei $l$ der zeitliche Abstand, mit dem Realisationen verfügbar werden
  \item $Y_{t + l} = Y_t + \lag Y_t$
  \item Die Nowcast schätzen (fehlerbehaftet) $\lag Y_t$ mithilfe von Daten, die zum Zeitpunkt $\tau \in T_t^k$ verfügbar sind, und dem neuesten, bekannten Wert $Y_t$:
	\begin{equation}
  		X_{t \lvert \tau}^k = Y_{\tau - l} + (\widehat{\lag[t-\tau+l] Y_t})_{t \lvert \tau}^k,
	\end{equation}
	wobei
		\begin{equation}
  			\lag[t-\tau+l] Y_t =  (\widehat{\lag[t-\tau+l] Y_t})_{t \lvert \tau}^k + \varepsilon.
		\end{equation}


\end{itemize}
\subsection{Weitere Ideen zu Trending}

\begin{itemize}
  \item \enquote{Schwaches} Trending für lag $l$: Wahrscheinlichkeit, in die gleiche Richtung zu zeigen ist größer als Wahrscheinlichkeit in die falsche Richtung zu zeigen (für lag $l$)
  \item \enquote{Downwards}-Trending: Trends in die negative Richtung werden erkannt, in die positive Richtung nicht
  \item \enquote{Upwards}-Trending: Trends in die positive Richtung werden erkannt, in die negative nicht
  \item Nicht einfach nur 0-1-Kodierung für gleiches Vorzeichen von $\lag x$ und $\lag y$, sondern Gewichtung des $\mathbb{R}^2$, sodass zum Beispiel Punkte nahe der Achsen weniger Gewicht bekommen als solche nahe der Winkelhalbierenden
  \item PCA auf $\lag x$ und $\lag y$, Bestrafung der zweiten Komponente (Abweichung von Gerade): Bestrafung würde aber mehr umfassen, als lediglich den Trend, sondern würde Abweichung von Linearität betreffen
  \item Falls wir Exclusion Area wollen und $\lag Y_t$ heteroskedastisch: relative Werte betrachten?
\end{itemize}

%\printbibliography


\end{document} 